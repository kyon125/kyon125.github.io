System.register("chunks:///_virtual/AIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var r,e,n,o;return{setters:[function(t){r=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,o=t.Component}],execute:function(){var a;e._RF.push({},"0a7c13Sqk9EdLreJohUKzkm","AIManager",void 0);var c=n.ccclass;n.property,t("AIManager",c("AIManager")(a=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var n=e.prototype;return n.start=function(){},n.update=function(t){},e}(o))||a);e._RF.pop()}}}));

System.register("chunks:///_virtual/AITest.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,n,r,i,o,a,l,s,u,p,c;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.Node,s=e.Sprite,u=e.tween,p=e.Color,c=e.Component}],execute:function(){var f,h,y,m,b,g,S,v,M,d,w,z,A,R,G;o._RF.push({},"3a02dCLbhdA3q22A8zG7HGl","AITest",void 0);var I=a.ccclass,T=a.property;e("AITest",(f=I("AITest"),h=T(l),y=T(l),m=T(l),b=T(l),g=T(l),S=T({type:s}),f((d=t((M=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,r(t,"player",d,i(t)),r(t,"enemy",w,i(t)),r(t,"seatMap",z,i(t)),r(t,"mapBG",A,i(t)),r(t,"map",R,i(t)),r(t,"maps",G,i(t)),t.selfSeat=[0,0],t.enemySeat=[4,4],t}n(t,e);var o=t.prototype;return o.start=function(){for(var e=0;e<this.map.children.length;e++)this.maps.push(this.map.children[e].getComponent(s));this.ShowMoveRange({x:5,y:5},2)},o.update=function(e){},o.playerMove=function(e,t){var n=this;x(3,this.selfSeat,[Math.floor(t/5),t%5])?(this.selfSeat=[Math.floor(t/5),t%5],console.log(this.selfSeat),u(this.player).set({position:this.map.children[t].position}).start(),this.ShowMoveRange({x:5,y:5},2),function(e,t,n,r){for(var i=Math.abs(t[0]-n[0]),o=Math.abs(t[1]-n[1]),a=0;a<e;a++)if(B(t,n)>1)if(i>=o){if(0===i)break;t[0]>n[0]?t[0]--:t[0]++,i--,console.log(t)}else{if(0===o)break;t[1]>n[1]?t[1]--:t[1]++,o--,console.log(t)}r(),B(t,n)<=1?console.log("已抵達，targetSeat:"+n+" selfSeat:"+t):console.log("移動至"+t)}(1,this.enemySeat,this.selfSeat,(function(){return u(n.enemy).set({position:n.seatMap.children[5*n.enemySeat[0]+n.enemySeat[1]].position}).start()}))):console.warn("移動距離過遠，無法移動到此位置")},o.ShowMoveRange=function(e,t){for(var n=e.x,r=e.y,i=0;i<n;i++)for(var o=0;o<r;o++)this.maps[i*n+o].color=x(t,this.selfSeat,[i,o])?p.BLUE:p.GRAY},t}(c)).prototype,"player",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(M.prototype,"enemy",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(M.prototype,"seatMap",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(M.prototype,"mapBG",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(M.prototype,"map",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(M.prototype,"maps",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=M))||v));function x(e,t,n){return e>=B(t,n)}function B(e,t){return Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])}o._RF.pop()}}}));

System.register("chunks:///_virtual/Arms.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameClass.ts","./SoundManager.ts"],(function(a){"use strict";var e,t,r,n,c,s,i;return{setters:[function(a){e=a.inheritsLoose,t=a.asyncToGenerator,r=a.regeneratorRuntime},function(a){n=a.cclegacy,c=a._decorator},function(a){s=a.Status},function(a){i=a.SoundManager}],execute:function(){var h;n._RF.push({},"79c67o6g+VERJ0OL0ePbB0k","Arms",void 0);var o=c.ccclass,u=(c.property,a("Arms",o("Arms")(h=function(a,e,t){this.gamemanager=void 0,this.viewer=void 0,this.characterData=void 0,this.attackRange=void 0,this.gamemanager=e,this.characterData=a,this.viewer=t})||h));a("Saber",function(a){function n(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=a.call.apply(a,[this].concat(r))||this).attackRange=[[-1,0],[1,0],[0,1],[0,-1]],e}e(n,a);var c=n.prototype;return c.GetAttackRange=function(a){var e=this,t=[];return this.attackRange.forEach((function(r){var n=a.Add(r);n.x>=0&&n.x<e.gamemanager.mapRange.x&&n.y>=0&&n.y<e.gamemanager.mapRange.y&&t.push(n)})),t},c.Attack=function(){var a=t(r().mark((function a(e){var n=this;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return this.viewer.HideBehaviorBtn(),a.next=3,new Promise(t(r().mark((function a(c){var h,o,u,f,m,g,p;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n.viewer.RefreshCurrentCharacterInfo(n.characterData),h=n.GetAttackRange(e),o=n.gamemanager.SearchCharacterInSeat(h),u=[],f=r().mark((function a(e){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o[e].tag===n.characterData.tag){a.next=3;break}return a.next=3,new Promise((function(a){i.Instance.PlaySEFX("SEFX_SwordAttack02"),n.viewer.PlayCharacterAnimation(n.characterData,s.Attack,t(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.viewer.ShowAttackHitEffect(n.gamemanager.GetMapPos(o[e].seat),"Effect_Hit"),t.next=3,o[e].Arm.GetDamage(n.characterData.currentAtk);case 3:u.push(o[e]),a();case 5:case"end":return t.stop()}}),t)}))))}));case 3:case"end":return a.stop()}}),a)})),m=0;case 6:if(!(m<o.length)){a.next=11;break}return a.delegateYield(f(m),"t0",8);case 8:m++,a.next=6;break;case 11:g=0;case 12:if(!(g<u.length)){a.next=24;break}p=0;case 14:if(!(p<n.gamemanager.charatersData.length)){a.next=21;break}if(n.gamemanager.charatersData[p].tag!=n.characterData.tag||n.characterData==n.gamemanager.charatersData[p]){a.next=18;break}return a.next=18,n.gamemanager.charatersData[p].Arm.ComboAttack(n.gamemanager.charatersData[p].seat,u[g]);case 18:p++,a.next=14;break;case 21:g++,a.next=12;break;case 24:n.gamemanager.isAttack=!1,c(),n.viewer.ShowBehaviorBtn();case 27:case"end":return a.stop()}}),a)}))));case 3:case"end":return a.stop()}}),a,this)})));return function(e){return a.apply(this,arguments)}}(),c.ComboAttack=function(){var a=t(r().mark((function a(e,n){var c,h,o=this;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(c=this.GetAttackRange(e),!(n.currentHp>0)){a.next=10;break}h=0;case 3:if(!(h<c.length)){a.next=10;break}if(!n.seat.CheakTheSame(c[h])){a.next=7;break}return a.next=7,new Promise((function(a){i.Instance.PlaySEFX("SEFX_SwordAttack02"),o.viewer.PlayCharacterAnimation(o.characterData,s.Attack,t(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("b3"),o.viewer.ShowAttackHitEffect(o.gamemanager.GetMapPos(n.seat),"Effect_Hit"),e.next=4,n.Arm.GetDamage(o.characterData.currentAtk);case 4:a();case 5:case"end":return e.stop()}}),e)}))))}));case 7:h++,a.next=3;break;case 10:case"end":return a.stop()}}),a,this)})));return function(e,t){return a.apply(this,arguments)}}(),c.GetDamage=function(){var a=t(r().mark((function a(e){var n,c;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e,c=0;case 2:if(!(c<e)){a.next=13;break}if(!(this.characterData.currentDef>0)){a.next=9;break}console.log("block--"),n--,this.characterData.currentDef--,a.next=10;break;case 9:return a.abrupt("break",13);case 10:c++,a.next=2;break;case 13:return(e=n)>0&&(this.characterData.currentHp-=e),this.viewer.RefreshSmallCharacterStatus(this.characterData),this.viewer.RefreshCurrentCharacterInfo(this.characterData),this.viewer.PlayCharacterAnimation(this.characterData,s.damage,t(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}}),a)})))),a.next=20,this.viewer.ShowCharacterHurtEffect(this.gamemanager.GetMapPos(this.characterData.seat),e);case 20:if(!(this.characterData.currentHp<=0)){a.next=23;break}return a.next=23,this.viewer.PlayCharacterDeath(this.characterData);case 23:case"end":return a.stop()}}),a,this)})));return function(e){return a.apply(this,arguments)}}(),n}(u)),a("Archer",function(a){function n(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=a.call.apply(a,[this].concat(r))||this).attackRange=[[-1,1],[-2,0],[-1,-1],[2,0],[1,-1],[0,-2],[1,1],[0,2]],e}e(n,a);var c=n.prototype;return c.ComboAttack=function(){var a=t(r().mark((function a(e,n){var c,h,o=this;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(c=this.GetAttackRange(e),!(n.currentHp>0)){a.next=10;break}h=0;case 3:if(!(h<c.length)){a.next=10;break}if(!n.seat.CheakTheSame(c[h])){a.next=7;break}return a.next=7,new Promise((function(a){i.Instance.PlaySEFX("SEFX_GunAttack"),o.viewer.PlayCharacterAnimation(o.characterData,s.Attack,t(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("b3"),o.viewer.ShowAttackHitEffect(o.gamemanager.GetMapPos(n.seat),"Effect_Hit"),e.next=4,n.Arm.GetDamage(o.characterData.currentAtk);case 4:a();case 5:case"end":return e.stop()}}),e)}))))}));case 7:h++,a.next=3;break;case 10:case"end":return a.stop()}}),a,this)})));return function(e,t){return a.apply(this,arguments)}}(),c.GetAttackRange=function(a){var e=this,t=[];return this.attackRange.forEach((function(r){var n=a.Add(r);n.x>=0&&n.x<e.gamemanager.mapRange.x&&n.y>=0&&n.y<e.gamemanager.mapRange.y&&t.push(n)})),t},c.Attack=function(){var a=t(r().mark((function a(e){var n=this;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return this.viewer.HideBehaviorBtn(),a.next=3,new Promise(t(r().mark((function a(c){var h,o,u,f,m,g,p;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n.viewer.RefreshCurrentCharacterInfo(n.characterData),h=n.GetAttackRange(e),o=n.gamemanager.SearchCharacterInSeat(h),u=[],f=r().mark((function a(e){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o[e].tag===n.characterData.tag){a.next=3;break}return a.next=3,new Promise((function(a){i.Instance.PlaySEFX("SEFX_GunAttack"),n.viewer.PlayCharacterAnimation(n.characterData,s.Attack,t(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.viewer.ShowAttackHitEffect(n.gamemanager.GetMapPos(o[e].seat),"Effect_Hit"),t.next=3,o[e].Arm.GetDamage(n.characterData.currentAtk);case 3:u.push(o[e]),a();case 5:case"end":return t.stop()}}),t)}))))}));case 3:case"end":return a.stop()}}),a)})),m=0;case 6:if(!(m<o.length)){a.next=11;break}return a.delegateYield(f(m),"t0",8);case 8:m++,a.next=6;break;case 11:g=0;case 12:if(!(g<u.length)){a.next=24;break}p=0;case 14:if(!(p<n.gamemanager.charatersData.length)){a.next=21;break}if(n.gamemanager.charatersData[p].tag!=n.characterData.tag||n.characterData==n.gamemanager.charatersData[p]){a.next=18;break}return a.next=18,n.gamemanager.charatersData[p].Arm.ComboAttack(n.gamemanager.charatersData[p].seat,u[g]);case 18:p++,a.next=14;break;case 21:g++,a.next=12;break;case 24:n.gamemanager.isAttack=!1,c(),n.viewer.ShowBehaviorBtn();case 27:case"end":return a.stop()}}),a)}))));case 3:case"end":return a.stop()}}),a,this)})));return function(e){return a.apply(this,arguments)}}(),c.GetDamage=function(){var a=t(r().mark((function a(e){var n,c;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e,c=0;case 2:if(!(c<e)){a.next=13;break}if(!(this.characterData.currentDef>0)){a.next=9;break}console.log("block--"),n--,this.characterData.currentDef--,a.next=10;break;case 9:return a.abrupt("break",13);case 10:c++,a.next=2;break;case 13:return(e=n)>0&&(this.characterData.currentHp-=e),this.viewer.RefreshSmallCharacterStatus(this.characterData),this.viewer.RefreshCurrentCharacterInfo(this.characterData),this.viewer.PlayCharacterAnimation(this.characterData,s.damage,t(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}}),a)})))),a.next=20,this.viewer.ShowCharacterHurtEffect(this.gamemanager.GetMapPos(this.characterData.seat),e);case 20:if(!(this.characterData.currentHp<=0)){a.next=23;break}return a.next=23,this.viewer.PlayCharacterDeath(this.characterData);case 23:case"end":return a.stop()}}),a,this)})));return function(e){return a.apply(this,arguments)}}(),n}(u));n._RF.pop()}}}));

System.register("chunks:///_virtual/CardManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){"use strict";var t,a,e,n,i;return{setters:[function(r){t=r.applyDecoratedDescriptor,a=r.initializerDefineProperty},function(r){e=r.cclegacy,n=r._decorator,i=r.CCString}],execute:function(){var o,u,c,p,d,s,l;e._RF.push({},"a95f8V/8NRNxrLYhbrpo4mZ","CardManager",void 0);var h=n.ccclass,f=n.property;r("CardManager",(o=h("CardManager"),u=f(i),c=f(i),o((s=t((d=function(){function r(r){a(this,"currentCardGroup",s,this),a(this,"HandleCard",l,this),this.InitialCardGroup(r)}var t=r.prototype;return t.InitialCardGroup=function(r){var t=this;this.HandleCard=[],0==this.currentCardGroup.length&&(this.currentCardGroup=[],r.forEach((function(r){for(var a=0;a<r.amount;a++)t.currentCardGroup.push(r.cardID)})))},t.TakeCard=function(r){for(var t=0;t<r;t++){var a=Math.floor(100*Math.random());if(this.currentCardGroup.length>0){for(;a>=this.currentCardGroup.length;)a=Math.floor(100*Math.random());this.HandleCard.push(this.currentCardGroup[a]),this.currentCardGroup.splice(a,1)}}},r}()).prototype,"currentCardGroup",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=t(d.prototype,"HandleCard",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=d))||p));e._RF.pop()}}}));

System.register("chunks:///_virtual/Cardtest.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var n,t,o,i,r,l,a,s,d,c,p,u,g,h;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,a=e.Camera,s=e.Sprite,d=e.Node,c=e.Prefab,p=e.tween,u=e.Vec3,g=e.instantiate,h=e.Component}],execute:function(){var f,b,y,v,C,E,w,S,m,x,O,M,A,I,P;r._RF.push({},"4d9bbtaAPtEr4joliOWw5u1","Cardtest",void 0);var _=l.ccclass,D=l.property;e("CardViewer",(f=_("CardViewer"),b=D(a),y=D(s),v=D(s),C=D(s),E=D(d),w=D(c),f((x=n((m=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),l=0;l<t;l++)r[l]=arguments[l];return n=e.call.apply(e,[this].concat(r))||this,o(n,"cam",x,i(n)),o(n,"cards",O,i(n)),o(n,"select",M,i(n)),n.original=void 0,n.isDrop=void 0,o(n,"Player",A,i(n)),o(n,"Center",I,i(n)),o(n,"source",P,i(n)),n.Allpos=[],n.startY=void 0,n}t(n,e);var r=n.prototype;return r.start=function(){this.Player.node.on(d.EventType.MOUSE_UP,(function(e){console.log("this is player")}))},r.update=function(e){},r.Initial=function(e){var n=this,t=(e.node.parent.eulerAngles.z,e.node.parent.parent.children.indexOf(e.node.parent));e.node.on(d.EventType.MOUSE_ENTER,(function(){n.isDrop||(console.log("MOUSE_ENTER"+e.node.parent.name+e.node.parent.getSiblingIndex()),e.node.parent.setSiblingIndex(100),console.log(e.node.parent.getSiblingIndex()),p(e.node).to(.1,{position:new u(e.node.position.x,250,0)}).start())}),this),e.node.on(d.EventType.MOUSE_LEAVE,(function(){n.isDrop||(console.log("MOUSE_LEAVE"+e.node.parent.name+e.node.parent.getSiblingIndex()),p(e.node).to(.1,{position:new u(e.node.position.x,220,0)}).start(),e.node.parent.setSiblingIndex(t))}),this),e.node.on(d.EventType.MOUSE_DOWN,(function(t){if(!n.isDrop){n.select=t.target,console.log("MOUSE_DOWN"+e.node.parent.name+e.node.parent.getSiblingIndex()),e.node.parent.setSiblingIndex(1e3);var o=n.cam.screenToWorld(new u(t.getLocationX(),t.getLocationY(),0));e.node.setPosition(new u(o.x-480,o.y-350+470,0)),e.node.parent.eulerAngles=new u(0,0,0),n.startY=t.getLocationY(),n.isDrop=!0}}),this),e.node.on(d.EventType.MOUSE_UP,(function(o){o.preventSwallow=!0,n.RemoveCard(),console.log(o.getLocationY()+"/"+n.startY),n.isDrop&&o.getLocationY()-n.startY<150&&(console.log("MOUSE_UP"+e.node.parent.name+e.node.parent.getSiblingIndex()),e.node.parent.setSiblingIndex(t),e.node.setPosition(n.Allpos[n.Center.children.indexOf(e.node.parent)]),e.node.parent.eulerAngles=new u(0,0,1*Math.floor(n.Center.children.length/2)-1*n.Center.children.indexOf(e.node.parent))),n.isDrop=!1}),this),e.node.on(d.EventType.TOUCH_MOVE,(function(t){if(n.isDrop){e.node.parent.setSiblingIndex(1e3);var o=n.cam.screenToWorld(new u(t.getLocationX(),t.getLocationY(),0));e.node.setPosition(new u(o.x-480,o.y-350+470,0))}}),this)},r.AddCard=function(){var e=g(this.source);this.Center.addChild(e),this.Initial(e.getComponentInChildren(s));var n=this.Center.children.length;this.Allpos=[];for(var t=0;t<n;t++)console.log(5*-Math.floor(this.Center.children.length/2)+10*t),this.Allpos.push(new u(55*-Math.floor(this.Center.children.length/2)+55*t,220,0)),this.Center.children[t].children[0].setPosition(this.Allpos[t]),this.Center.children[t].eulerAngles=new u(0,0,1*Math.floor(this.Center.children.length/2)-1*t)},r.RemoveCard=function(){},n}(h)).prototype,"cam",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=n(m.prototype,"cards",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=n(m.prototype,"select",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=n(m.prototype,"Player",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=n(m.prototype,"Center",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=n(m.prototype,"source",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=m))||S));r._RF.pop()}}}));

System.register("chunks:///_virtual/CardViewer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts","./GameData.ts","./GameClass.ts","./SoundManager.ts"],(function(e){"use strict";var n,t,a,r,o,i,s,l,c,p,d,u,g,m,C,h,f,y,v,S,b;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,i=e._decorator,s=e.Camera,l=e.Sprite,c=e.Node,p=e.Prefab,d=e.Layout,u=e.tween,g=e.Vec3,m=e.instantiate,C=e.Label,h=e.UIOpacity,f=e.Component},function(e){y=e.GameManager},function(e){v=e.GameData},function(e){S=e.SeatConvertMapSeat},function(e){b=e.SoundManager}],execute:function(){var D,E,w,I,T,x,_,M,N,L,O,R,P;o._RF.push({},"18c78/U+7dEeYEo2y1mqQmk","CardViewer",void 0);var U=i.ccclass,z=i.property;e("CardViewer",(D=U("CardViewer"),E=z(s),w=z(l),I=z(y),T=z(c),x=z(p),D((N=n((M=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,a(n,"cam",N,r(n)),a(n,"select",L,r(n)),a(n,"manager",O,r(n)),n.original=void 0,n.isDrop=void 0,a(n,"Center",R,r(n)),a(n,"source",P,r(n)),n.startY=void 0,n}t(n,e);var o=n.prototype;return o.start=function(){},o.update=function(e){},o.Initial=function(e){var n=this;e.node.on(c.EventType.MOUSE_ENTER,(function(t){n.isDrop||(n.Center.getComponent(d).type=d.Type.NONE,e.node.parent.setSiblingIndex(100),b.Instance.PlayContinueSEFX("SEFX_CardSelect"),u(e.node).to(.1,{position:new g(e.node.position.x,220,0)}).start())}),this),e.node.on(c.EventType.MOUSE_LEAVE,(function(){n.isDrop||(u(e.node).to(.1,{position:new g(e.node.position.x,170,0)}).start(),e.node.parent.setSiblingIndex(Number(e.node.parent.name)))}),this),e.node.on(c.EventType.MOUSE_DOWN,(function(t){if(!n.isDrop){n.select=e,n.Center.getComponent(d).type=d.Type.NONE,e.node.parent.setSiblingIndex(100);var a=n.cam.screenToWorld(new g(t.getLocationX(),t.getLocationY(),0));e.node.parent.setPosition(new g(a.x-480,a.y-40,0)),n.startY=t.getLocationY(),n.isDrop=!0,null!==n.manager.selectCharaterData&&(n.manager.selectCharaterData.behaviorStatus="idel",n.manager.mapData.Initial(),n.manager.viewer.CancelShowRange(),u(n.manager.selectCharaterData.prefab).set({position:n.manager.map.children[S(n.manager.selectCharaterData.seat,n.manager.mapData.mapRange)].position}).start(),n.manager.selectCharaterData=null,n.manager.viewer.ShowBehaviorBtn())}}),this),e.node.on(c.EventType.MOUSE_UP,(function(t){t.preventSwallow=!0,n.manager.SetEffectIndex(e.node.parent.name),n.manager.isDrop=!0,n.select==e&&(n.HomingCard(Number(e.node.parent.name)),n.isDrop=!1),n.SetCardAlpha(e.node,255)}),this),e.node.on(c.EventType.TOUCH_MOVE,(function(t){if(n.isDrop){e.node.parent.setSiblingIndex(100);var a=n.cam.screenToWorld(new g(t.getLocationX(),t.getLocationY(),0));e.node.parent.setPosition(new g(a.x-480,a.y-40,0)),b.Instance.PlayContinueSEFX("SEFX_CardMove"),n.SetCardAlpha(e.node,100)}}),this)},o.AddCard=function(e,n){for(var t=0;t<e;t++){var a=m(this.source);this.Center.addChild(a),a.name=(this.Center.children.length-1).toString(),this.Initial(a.getComponentInChildren(l)),this.RefreshCardInfo(a,n[t])}this.Center.children.length;this.Center.getComponent(d).type=d.Type.GRID},o.HomingCard=function(e){this.select.node.parent.setSiblingIndex(e),this.Center.getComponent(d).type=d.Type.GRID},o.RemoveCard=function(){this.select.node.parent.destroy(),this.select=null},o.RefreshCardInfo=function(e,n){var t=e.children[0].getChildByName("Txt_Header").getComponent(C),a=e.children[0].getChildByName("Txt_Content").getComponent(C),r=null;v.Instance.cardDatas.forEach((function(e){e.CardID==n&&(r=e)}));try{t.string=r.CardName,a.string=r.Description}catch(e){console.log("找不到此卡片資料")}},o.SetCardAlpha=function(e,n){e.getComponent(h).opacity=n},n}(f)).prototype,"cam",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=n(M.prototype,"select",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=n(M.prototype,"manager",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=n(M.prototype,"Center",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=n(M.prototype,"source",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=M))||_));o._RF.pop()}}}));

System.register("chunks:///_virtual/CharacterViewer.ts",["cc"],(function(e){"use strict";var r,t,c;return{setters:[function(e){r=e.cclegacy,t=e._decorator,c=e.Vec3}],execute:function(){var i;r._RF.push({},"98228KZNBJPtpvh0BHYp1g+","CharacterViewer",void 0);var s=t.ccclass;t.property,e("CharacterViewer",s("CharacterViewer")(i=function(e,r,t){this.sprite=void 0,this.sprite=e;var i=this.sprite.node.parent.scale;this.sprite.node.parent.scale="Friendly"===t?i:new c(-i.x,i.y,i.z)})||i);r._RF.pop()}}}));

System.register("chunks:///_virtual/EffectManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SoundManager.ts"],(function(t){"use strict";var n,e,i,r,a,o,c,s,u,f,l,p,g,b,H;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized,a=t.asyncToGenerator,o=t.regeneratorRuntime},function(t){c=t.cclegacy,s=t._decorator,u=t.Label,f=t.Animation,l=t.Component,p=t.tween,g=t.Vec3,b=t.easing},function(t){H=t.SoundManager}],execute:function(){var v,y,m,h,d,A,L;c._RF.push({},"bc397ZCKX1LAaZejnK9o5OH","EffectManager",void 0);var E=s.ccclass,w=s.property;t("EffectManager",(v=E("EffectManager"),y=w(u),m=w(f),v((A=n((d=function(t){function n(){for(var n,e=arguments.length,a=new Array(e),o=0;o<e;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a))||this,i(n,"HartLabels",A,r(n)),i(n,"HitAnimations",L,r(n)),n}e(n,t);var c=n.prototype;return c.HurtEffect=function(){var t=a(o().mark((function t(n,e){var i=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){for(var r=function(r){if(!i.HartLabels[r].node.activeInHierarchy)return i.HartLabels[r].string="-"+e.toString(),i.HartLabels[r].node.active=!0,H.Instance.PlaySEFX("SEFX_Damage"),p(i.HartLabels[r].node).set({position:new g(n.x,n.y+20,n.z)}).by(.4,{position:new g(0,20,0)},{easing:b.quintOut}).call((function(){i.HartLabels[r].node.active=!1,console.log("gggg"),t()})).start(),"break"},a=0;a<i.HartLabels.length;a++){if("break"===r(a))break}})));case 1:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}(),c.HitEffect=function(t,n){for(var e=this,i=function(i){if(!e.HitAnimations[i].node.activeInHierarchy)return p(e.HitAnimations[i].node).set({position:t}).call((function(){e.HitAnimations[i].node.active=!0,e.HitAnimations[i].play(n),e.HitAnimations[i].on(f.EventType.FINISHED,(function(){e.HitAnimations[i].node.active=!1}),e),console.log("hit_eff")})).start(),"break"},r=0;r<this.HitAnimations.length;r++){if("break"===i(r))break}},n}(l)).prototype,"HartLabels",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=n(d.prototype,"HitAnimations",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=d))||h));c._RF.pop()}}}));

System.register("chunks:///_virtual/GameClass.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,r,i,n,a,u,o,l,c;return{setters:[function(t){e=t.inheritsLoose,r=t.applyDecoratedDescriptor,i=t.initializerDefineProperty},function(t){n=t.cclegacy,a=t._decorator,u=t.CCInteger,o=t.CCString,l=t.Node,c=t.Component}],execute:function(){var s,b,f,p,h,m,y,g,w,x,z,C,d,S,v,D,k,A,M,H,I,R,E,G,P,_,F,T,L,V,j,B,N,Q,X,Y,q,J,K,O,U,W,Z,$,tt,et,rt,it,nt,at,ut,ot,lt,ct,st;t({MapSeatConvertSeat:function(t,e){return new ht(t%e.x,Math.floor(t/e.x))},SeatConvertMapSeat:function(t,e){return t.y*e.x+t.x},Status:void 0,targetDistance:function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}}),n._RF.push({},"d42d9Y3QVVC84+RxcaDXsnt","GameClass",void 0);var bt,ft=a.ccclass,pt=a.property,ht=(t("GameClass",ft("GameClass")(s=function(t){function r(){return t.apply(this,arguments)||this}return e(r,t),r}(c))||s),t("Player",(b=ft("Player"),f=pt(u),p=pt(u),h=pt(u),m=pt(u),b((w=r((g=function(){i(this,"maxCost",w,this),i(this,"currentCost",x,this),i(this,"maxEnergy",z,this),i(this,"currentEnergy",C,this)}).prototype,"maxCost",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),x=r(g.prototype,"currentCost",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=r(g.prototype,"maxEnergy",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),C=r(g.prototype,"currentEnergy",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y=g))||y)),t("Seat",(d=ft("Seat"),S=pt(u),v=pt(u),d((A=r((k=function(){function t(t,e){i(this,"x",A,this),i(this,"y",M,this),this.x=null==t?0:t,this.y=null==e?0:e}var e=t.prototype;return e.Add=function(e){return new t(this.x+e[0],this.y+e[1])},e.CheakTheSame=function(t){return t.x==this.x&&t.y==this.y},t}()).prototype,"x",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),M=r(k.prototype,"y",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),D=k))||D)));t("Character",(H=ft("Character"),I=pt(o),R=pt(o),E=pt(l),G=pt(ht),P=pt(u),_=pt(u),F=pt(u),T=pt(u),L=pt(u),V=pt(u),j=pt(u),B=pt(o),N=pt(o),H((Y=r((X=function(){i(this,"name",Y,this),i(this,"tag",q,this),i(this,"prefab",J,this),i(this,"seat",K,this),i(this,"basAtk",O,this),i(this,"currentMoveRange",U,this),i(this,"currentAtk",W,this),i(this,"maxHp",Z,this),i(this,"currentHp",$,this),i(this,"maxDef",tt,this),i(this,"currentDef",et,this),i(this,"behaviorStatus",rt,this),i(this,"armTag",it,this),this.Arm=null}).prototype,"name",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"預設名稱"}}),q=r(X.prototype,"tag",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Friendly"}}),J=r(X.prototype,"prefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=r(X.prototype,"seat",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ht(0,0)}}),O=r(X.prototype,"basAtk",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),U=r(X.prototype,"currentMoveRange",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),W=r(X.prototype,"currentAtk",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Z=r(X.prototype,"maxHp",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),$=r(X.prototype,"currentHp",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),tt=r(X.prototype,"maxDef",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),et=r(X.prototype,"currentDef",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),rt=r(X.prototype,"behaviorStatus",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"idel"}}),it=r(X.prototype,"armTag",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Saber"}}),Q=X))||Q)),t("Card",(nt=ft("Card"),at=pt(o),ut=pt(u),nt((ct=r((lt=function(){i(this,"cardID",ct,this),i(this,"amount",st,this)}).prototype,"cardID",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),st=r(lt.prototype,"amount",[ut],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ot=lt))||ot));!function(t){t[t.Idel=0]="Idel",t[t.Attack=1]="Attack",t[t.damage=2]="damage"}(bt||(bt=t("Status",{}))),n._RF.pop()}}}));

System.register("chunks:///_virtual/GameData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameClass.ts"],(function(t){"use strict";var e,a,r,i,n,o,u,s,c,l,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,a=t.initializerDefineProperty,r=t.inheritsLoose,i=t.assertThisInitialized},function(t){n=t.cclegacy,o=t._decorator,u=t.CCString,s=t.CCInteger,c=t.director,l=t.Component},function(t){p=t.Character}],execute:function(){var f,h,b,g,D,d,m,C,y,z,w,S,I,v,G,L,_,x,N,P,R,V,j,A,B,E,F,H,O,T;n._RF.push({},"9880eHxlOZGhLVBA2xTXECq","GameData",void 0);var k=o.ccclass,q=o.property,M=t("CardData",(f=k("CardData"),h=q(u),b=q(u),g=q(s),D=q(s),d=q(u),f((y=e((C=function(){a(this,"CardID",y,this),a(this,"CardName",z,this),a(this,"Cost",w,this),a(this,"Value",S,this),a(this,"Description",I,this)}).prototype,"CardID",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),z=e(C.prototype,"CardName",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),w=e(C.prototype,"Cost",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),S=e(C.prototype,"Value",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),I=e(C.prototype,"Description",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),m=C))||m)),X=t("StageData",(v=k("StageData"),G=q(s),L=q(p),v((N=e((x=function(){a(this,"stageID",N,this),a(this,"charatersDatas",P,this)}).prototype,"stageID",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),P=e(x.prototype,"charatersDatas",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=x))||_));t("GameData",(R=k("GameData"),V=q(s),j=q(M),A=q(X),R(((T=function(t){function e(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return e=t.call.apply(t,[this].concat(n))||this,a(e,"currentStage",F,i(e)),a(e,"cardDatas",H,i(e)),a(e,"stageCharatersData",O,i(e)),e}r(e,t);var n=e.prototype;return n.onLoad=function(){null==e.Instance&&(e.Instance=this),c.addPersistRootNode(this.node.parent)},n.GetStageData=function(){var t=[];return this.stageCharatersData[this.currentStage].charatersDatas.forEach((function(e){t.push(Object.assign({},e))})),t},n.SetStage=function(t){this.currentStage=t},e}(l)).Instance=null,F=e((E=T).prototype,"currentStage",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),H=e(E.prototype,"cardDatas",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=e(E.prototype,"stageCharatersData",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=E))||B));n._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Arms.ts","./GameViewer.ts","./GameClass.ts","./MoveManager.ts","./CardManager.ts","./GameData.ts","./EffectManager.ts","./SoundManager.ts"],(function(a){"use strict";var e,t,r,n,i,s,c,o,h,l,u,f,p,g,D,m,d,v,y,b,C,S,w,E,M,R,I,x,k,A,B,P,G;return{setters:[function(a){e=a.applyDecoratedDescriptor,t=a.inheritsLoose,r=a.initializerDefineProperty,n=a.assertThisInitialized,i=a.asyncToGenerator,s=a.regeneratorRuntime},function(a){c=a.cclegacy,o=a._decorator,h=a.CCString,l=a.Node,u=a.Prefab,f=a.Layout,p=a.instantiate,g=a.Sprite,D=a.Color,m=a.tween,d=a.Component,v=a.Vec3},function(a){y=a.Archer,b=a.Saber},function(a){C=a.GameViewer},function(a){S=a.Seat,w=a.Character,E=a.Player,M=a.Card,R=a.SeatConvertMapSeat,I=a.targetDistance,x=a.MapSeatConvertSeat},function(a){k=a.MoveManager},function(a){A=a.CardManager},function(a){B=a.GameData},function(a){P=a.EffectManager},function(a){G=a.SoundManager}],execute:function(){var F,_,T,z,X,L,N,O,H,U,V,W,Y,j,K,q,J,Q,Z,$,aa,ea,ta,ra,na,ia,sa,ca,oa,ha,la;c._RF.push({},"d4ebecdKeBN172SD66punFI","GameManager",void 0);var ua=o.ccclass,fa=o.property;a("GameManager",(F=ua("GameManager"),_=fa(h),T=fa(l),z=fa(S),X=fa(u),L=fa(l),N=fa(u),O=fa(w),H=fa(E),U=fa(w),V=fa(S),W=fa(M),Y=fa(A),j=fa(P),K=fa(l),F((Q=e((J=function(a){function e(){for(var e,t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e=a.call.apply(a,[this].concat(i))||this,r(e,"turnStatus",Q,n(e)),r(e,"map",Z,n(e)),r(e,"mapRange",$,n(e)),r(e,"mapPrefab",aa,n(e)),r(e,"charaters",ea,n(e)),r(e,"charaterPrefab",ta,n(e)),r(e,"charatersData",ra,n(e)),r(e,"playerData",na,n(e)),r(e,"selectCharaterData",ia,n(e)),r(e,"targetSeat",sa,n(e)),r(e,"CardGroupData",ca,n(e)),r(e,"cardManager",oa,n(e)),r(e,"effectManager",ha,n(e)),r(e,"effectTarget",la,n(e)),e.currentEffectIndex=0,e.isAttack=!1,e.isDrop=!1,e.mapData=null,e.viewer=void 0,e.mapSprite=[],e}t(e,a);var c=e.prototype;return c.start=function(){this.Initial(),this.RegisterButton(),this.viewer.Initial(this)},c.update=function(a){},c.Initial=function(){var a=this;B.Instance.currentStage==B.Instance.stageCharatersData.length-1?G.Instance.PlayBGM("MainBattle",!0):G.Instance.PlayBGM("MainBattle02",!0),this.viewer=this.node.getComponent(C);var e=this.map.getComponent(f);this.charatersData=B.Instance.GetStageData(),this.mapData=new k(this.charatersData,this.mapRange),this.cardManager=new A(this.CardGroupData),e.constraintNum=this.mapRange.x;for(var t=0;t<this.mapRange.x*this.mapRange.y;t++){var r=p(this.mapPrefab);r.name="m"+t;var n=r.getComponent(g);this.map.addChild(r),this.mapSprite.push(n)}e.updateLayout();for(var i=function(e){var t=p(a.charaterPrefab);a.charatersData[e].prefab=t,a.charaters.addChild(t),t.setPosition(a.map.children[R(a.charatersData[e].seat,a.mapRange)].position);var r=a.charatersData[e];switch(r.armTag){case"Saber":r.Arm=new b(r,a,a.viewer);break;case"Archer":r.Arm=new y(r,a,a.viewer)}r.prefab.getChildByName("Btn_character").on(l.EventType.MOUSE_UP,(function(){a.isDrop&&!a.isAttack&&(a.UseEffectSuccess(r)&&(a.viewer.UseCard(),a.viewer.RefreshCurrentPlayerInfo(a.playerData)),a.isDrop=!1)})),a.viewer.InitialSmallCharacterStatus(r)},s=0;s<this.charatersData.length;s++)i(s);this.PlayerInitial(),this.cardManager.TakeCard(5),this.viewer.TakeCardAni(5,this.cardManager.HandleCard)},c.RegisterButton=function(){var a=this;this.charatersData.forEach((function(e){e.prefab.getChildByName("Btn_character").on(l.EventType.MOUSE_ENTER,(function(){"Enemy"!=e.tag&&(null==a.selectCharaterData?a.viewer.RenderAttackRange(e.Arm.GetAttackRange(e.seat),D.YELLOW):a.selectCharaterData==e?a.viewer.RenderAttackRange(e.Arm.GetAttackRange(a.targetSeat),D.YELLOW):a.viewer.RenderAttackRange(e.Arm.GetAttackRange(e.seat),D.YELLOW)),a.isDrop=!1}),a),e.prefab.getChildByName("Btn_character").on(l.EventType.MOUSE_LEAVE,(function(){"Enemy"!=e.tag&&a.viewer.CancelShowRange()}),a),e.prefab.getChildByName("Btn_character").on("click",(function(){a.TouchMove(e),a.viewer.ShowBehaviorBtn()}),a)}));for(var e=this.map.children.length,t=function(e){var t=x(e,a.mapRange);a.map.children[e].on(l.EventType.MOUSE_DOWN,(function(){"Friendly"==a.turnStatus&&(a.mapData.SearchSeatCanArrived(t)?(console.log("可以移動到這裡"),a.targetSeat=x(e,a.mapRange),G.Instance.PlaySEFX("SEFX_FriendMove"),m(a.selectCharaterData.prefab).set({position:a.map.children[e].position}).start()):(console.log("不可以移到這裡"),null!==a.selectCharaterData&&(a.selectCharaterData.behaviorStatus="idel",a.mapData.Initial(),a.viewer.CancelShowRange(),G.Instance.PlaySEFX("SEFX_Cancel"),m(a.selectCharaterData.prefab).set({position:a.map.children[R(a.selectCharaterData.seat,a.mapData.mapRange)].position}).start(),a.selectCharaterData=null)),a.viewer.ShowBehaviorBtn())}),a)},r=0;r<e;r++)t(r)},c.PlayerInitial=function(){this.playerData.currentEnergy=this.playerData.maxEnergy,this.playerData.currentCost=this.playerData.maxCost,this.viewer.RefreshCurrentPlayerInfo(this.playerData)},c.InitialDemoMove=function(){m(this.selectCharaterData.prefab).set({position:this.mapSprite[R(this.selectCharaterData.seat,this.mapData.mapRange)].node.position}).start(),this.selectCharaterData.behaviorStatus="idel",this.mapData.Initial(),this.viewer.CancelShowRange(),G.Instance.PlaySEFX("SEFX_Cancel"),this.selectCharaterData=null},c.EnsureMove=function(){this.playerData.currentEnergy-=I(this.selectCharaterData.seat,this.targetSeat),this.selectCharaterData.seat=this.targetSeat,this.InitialDemoMove(),this.viewer.RefreshCurrentPlayerInfo(this.playerData),this.viewer.ShowBehaviorBtn()},c.TouchMove=function(a){var e=this;"Enemy"!=a.tag?"idel"===a.behaviorStatus?(G.Instance.PlaySEFX("SEFX_CharacterSelect"),this.charatersData.forEach((function(a){"moving"===a.behaviorStatus&&e.InitialDemoMove()})),this.targetSeat=a.seat,this.selectCharaterData=a,this.selectCharaterData.behaviorStatus="moving",this.mapData.MoveInitial(a.seat,a.currentMoveRange<=this.playerData.currentEnergy?a.currentMoveRange:this.playerData.currentEnergy),this.viewer.RenderMoveRange(),this.viewer.RefreshCurrentCharacterInfo(a)):(this.EnsureMove(),G.Instance.PlaySEFX("SEFX_Cancel")):this.viewer.RefreshCurrentCharacterInfo(a)},c.SearchCharacterInSeat=function(a){var e=this,t=[];return a.forEach((function(a){for(var r=0;r<e.charatersData.length;r++)if(a.x===e.charatersData[r].seat.x&&a.y===e.charatersData[r].seat.y){t.push(e.charatersData[r]);break}})),t},c.ChangeTurn=function(){G.Instance.PlaySEFX("SEFX_CharacterSelect"),this.turnStatus="Enemy",this.EnemyAction()},c.EnemyAction=function(){var a=i(s().mark((function a(){var e,t,r,n=this;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:this.viewer.HideBehaviorBtn(),this.viewer.CleanHandleCard(),this.charatersData.forEach((function(a){"Enemy"==a.tag&&(a.maxDef=0,a.currentDef=0,n.viewer.RefreshSmallCharacterStatus(a))})),e=s().mark((function a(e){var t,r,i,c,o,h,l;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=!1,"Enemy"!==n.charatersData[e].tag){a.next=37;break}r=!1,i=n.SearchCharacterInSeat(n.charatersData[e].Arm.GetAttackRange(n.charatersData[e].seat)),c=0;case 5:if(!(c<i.length)){a.next=13;break}if("Enemy"==i[c].tag){a.next=10;break}return r=!0,t=!0,a.abrupt("break",13);case 10:c++,a.next=5;break;case 13:if(!r){a.next=18;break}return a.next=16,n.charatersData[e].Arm.Attack(n.charatersData[e].seat);case 16:a.next=20;break;case 18:return a.next=20,new Promise((function(a){for(var t=null,r=function(a){if("Enemy"!==n.charatersData[a].tag){var r=[];[[-1,0],[1,0],[0,1],[0,-1]].forEach((function(e){var t=n.charatersData[a].seat.Add(e);t.x>=0&&t.x<n.mapRange.x&&t.y>=0&&t.y<n.mapRange.y&&r.push(t)})),r.forEach((function(r){n.mapData.BigMap[r.y][r.x]&&(null==t||I(n.charatersData[e].seat,r)<=t.distant)&&(t={distant:I(n.charatersData[e].seat,r),data:n.charatersData[a],targetSeat:r})})),null==t&&(t={distant:I(n.charatersData[e].seat,n.charatersData[a].seat),data:n.charatersData[a],targetSeat:n.charatersData[a].seat})}},i=0;i<n.charatersData.length;i++)r(i);n.mapData.MoveInitial(n.charatersData[e].seat,n.charatersData[e].currentMoveRange);for(var s=null,c=0;c<n.mapRange.y;c++)for(var o=0;o<n.mapRange.x;o++)n.mapData.moveMap[c][o].canArrvied&&(null==s||I(new S(o,c),t.targetSeat)<=s.distant)&&(s={distant:I(new S(o,c),t.targetSeat),seat:new S(o,c)});if(null!=s.seat)if(s.seat.CheakTheSame(n.charatersData[e].seat))a();else{n.charatersData[e].seat=s.seat;var h=n.mapSprite[R(s.seat,n.mapData.mapRange)].node.position;G.Instance.PlaySEFX("SEFX_EnemyMove");var l=n.charatersData[e].prefab;l.position.x>=h.x?l.scale=new v(-Math.abs(l.scale.x),l.scale.y,l.scale.y):l.scale=new v(Math.abs(l.scale.x),l.scale.y,l.scale.y),m(n.charatersData[e].prefab).by(.2,{position:new v(h.x-n.charatersData[e].prefab.position.x,0,0)}).by(.2,{position:new v(0,h.y-n.charatersData[e].prefab.position.y,0)}).call(a).start()}}));case 20:if(t){a.next=37;break}o=!1,h=n.SearchCharacterInSeat(n.charatersData[e].Arm.GetAttackRange(n.charatersData[e].seat)),l=0;case 24:if(!(l<h.length)){a.next=32;break}if("Enemy"==h[l].tag){a.next=29;break}return o=!0,t=!0,a.abrupt("break",32);case 29:l++,a.next=24;break;case 32:if(!o){a.next=37;break}return console.log(n.charatersData[e].name+" ssss"),n.viewer.HideBehaviorBtn(),a.next=37,n.charatersData[e].Arm.Attack(n.charatersData[e].seat);case 37:case"end":return a.stop()}}),a)})),t=0;case 5:if(!(t<this.charatersData.length)){a.next=10;break}return a.delegateYield(e(t),"t0",7);case 7:t++,a.next=5;break;case 10:return this.turnStatus="Friendly",this.mapData.Initial(),this.PlayerInitial(),this.charatersData.forEach((function(a){"Friendly"==a.tag&&(a.maxDef=0,a.currentDef=0,n.viewer.RefreshSmallCharacterStatus(a))})),this.cardManager.InitialCardGroup(this.CardGroupData),r=this.cardManager.currentCardGroup.length>=5?5:this.cardManager.currentCardGroup.length,this.cardManager.TakeCard(r),this.viewer.TakeCardAni(r,this.cardManager.HandleCard),this.viewer.ShowBehaviorBtn(),a.abrupt("return",!0);case 20:case"end":return a.stop()}}),a,this)})));return function(){return a.apply(this,arguments)}}(),c.SetEffectIndex=function(a){this.currentEffectIndex=Number(a)},c.UseEffectSuccess=function(a){for(var e=Number(this.cardManager.HandleCard[this.currentEffectIndex]),t=null,r=0;r<B.Instance.cardDatas.length;r++)if(B.Instance.cardDatas[r].CardID==e.toString()){t=B.Instance.cardDatas[r];break}if(this.playerData.currentCost>=t.Cost)switch(e){case 0:return console.error("確認資料技能效果id是否填錯"),!1;case 1:return"Friendly"==a.tag?(this.isAttack=!0,a.Arm.Attack(a.seat),console.log("攻擊"),this.playerData.currentCost-=t.Cost,!0):(console.log("無法攻擊"),!1);case 2:return"Friendly"==a.tag?(this.playerData.currentCost-=t.Cost,a.maxDef+=t.Value,a.currentDef+=t.Value,console.log("增加格檔值"),this.viewer.RefreshSmallCharacterStatus(a),this.viewer.RefreshCurrentCharacterInfo(a),!0):(console.log("錯誤，方法ID:2"),!1);default:return console.error("確認資料技能效果id是否填錯"),!1}},c.GetMapPos=function(a){return this.mapSprite[R(a,this.mapData.mapRange)].node.position},c.CheckMatch=function(){var a=this,e=!1,t=!1;this.charatersData.forEach((function(e){e.currentHp<=0&&(e.prefab.destroy(),a.charatersData.splice(a.charatersData.indexOf(e),1))}));for(var r=0;r<this.charatersData.length;r++)e||"Friendly"==this.charatersData[r].tag&&(e=!0);for(var n=0;n<this.charatersData.length;n++)t||"Enemy"==this.charatersData[n].tag&&(t=!0);return e?t?"Matching":"Victory":"Defeat"},e}(d)).prototype,"turnStatus",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Friendly"}}),Z=e(J.prototype,"map",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=e(J.prototype,"mapRange",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),aa=e(J.prototype,"mapPrefab",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ea=e(J.prototype,"charaters",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ta=e(J.prototype,"charaterPrefab",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ra=e(J.prototype,"charatersData",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),na=e(J.prototype,"playerData",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new E}}),ia=e(J.prototype,"selectCharaterData",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sa=e(J.prototype,"targetSeat",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new S(0,0)}}),ca=e(J.prototype,"CardGroupData",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),oa=e(J.prototype,"cardManager",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ha=e(J.prototype,"effectManager",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),la=e(J.prototype,"effectTarget",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=J))||q));c._RF.pop()}}}));

System.register("chunks:///_virtual/GameViewer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StatusViewer.ts","./GameClass.ts","./PlayerViewer.ts","./CharacterViewer.ts","./MapViewer.ts","./CardViewer.ts","./SmallCharacterViewer.ts","./EffectManager.ts","./SoundManager.ts","./ResultViewer.ts"],(function(e){"use strict";var t,a,r,n,i,o,s,c,u,l,h,f,m,p,g,w,S,b,d,C,y,v,V,R,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized,i=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e._decorator,u=e.Camera,l=e.Button,h=e.Sprite,f=e.Animation,m=e.Color,p=e.Component},function(e){g=e.StatusViewer},function(e){w=e.SeatConvertMapSeat,S=e.Seat},function(e){b=e.PlayerViewer},function(e){d=e.CharacterViewer},function(e){C=e.MapViewer},function(e){y=e.CardViewer},function(e){v=e.SmallCharacterViewer},function(e){V=e.EffectManager},function(e){R=e.SoundManager},function(e){M=e.ResultViewer}],execute:function(){var E,k,D,F,A,P,I,x,H,_,z,B,G,T,L,N,X,Y,W,j,U;s._RF.push({},"b108aKU+jlB8JmkZFaaxFk9","GameViewer",void 0);var J=c.ccclass,K=c.property;e("GameViewer",(E=J("GameViewer"),k=K(u),D=K(l),F=K(l),A=K(g),P=K(g),I=K(b),x=K(y),H=K(V),_=K(M),E((G=t((B=function(e){function t(){for(var t,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,r(t,"mainCam",G,n(t)),r(t,"btn_EnsureMove",T,n(t)),r(t,"btn_EndTurn",L,n(t)),r(t,"FriendStatus",N,n(t)),r(t,"EnemyStatus",X,n(t)),r(t,"playerStatus",Y,n(t)),t.mapViewer=void 0,t.characterViewer=new Map,r(t,"cardViewer",W,n(t)),r(t,"effectManager",j,n(t)),r(t,"resultViewer",U,n(t)),t.manager=null,t}a(t,e);var s=t.prototype;return s.Initial=function(e){this.manager=e,this.mapViewer=new C(this.manager.mapSprite,this.manager.mapRange),this.InitialCharacterViewer(),this.RefreshCurrentPlayerInfo(this.manager.playerData)},s.InitialCharacterViewer=function(){for(var e=0;e<this.manager.charatersData.length;e++){this.manager.charatersData[e].prefab.setPosition(this.manager.map.children[w(this.manager.charatersData[e].seat,this.manager.mapRange)].position);var t=new d(this.manager.charatersData[e].prefab.getComponentInChildren(h),this.manager.charatersData[e].prefab.getComponent(f),this.manager.charatersData[e].tag);this.characterViewer.set(e,t)}},s.RefreshCurrentCharacterInfo=function(e){"Friendly"===e.tag?(R.Instance.PlaySEFX("SEFX_CharacterInfo"),this.FriendStatus.SetName(e.name),this.FriendStatus.SetHP(e.currentHp,e.maxHp),this.FriendStatus.SetBlock(e.currentDef,e.maxDef),this.FriendStatus.SetCharacterValue(e.currentAtk,e.currentMoveRange),this.FriendStatus.CallFriendInfoShow()):(R.Instance.PlaySEFX("SEFX_CharacterInfo"),this.EnemyStatus.SetName(e.name),this.EnemyStatus.SetHP(e.currentHp,e.maxHp),this.EnemyStatus.SetBlock(e.currentDef,e.maxDef),this.EnemyStatus.SetCharacterValue(e.currentAtk,e.currentMoveRange),this.EnemyStatus.CallFriendInfoShow())},s.InitialSmallCharacterStatus=function(e){e.prefab.getComponent(v).Initial(e)},s.RefreshSmallCharacterStatus=function(e){try{var t=e.prefab.getComponent(v);t.SetBlock(),t.SetHp()}catch(e){}},s.PlayCharacterAnimation=function(){var e=i(o().mark((function e(t,a,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){try{t.prefab.getComponent(v).PlayCharacterAni(a,r)}catch(e){}}));case 2:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),s.PlayCharacterDeath=function(){var e=i(o().mark((function e(t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("match"),a=t.prefab.getComponent(v),e.next=5,a.PlayCharacterDeath();case 5:e.t0=this.manager.CheckMatch(),e.next="Matching"===e.t0?8:"Victory"===e.t0?9:"Defeat"===e.t0?11:13;break;case 8:return e.abrupt("break",13);case 9:return this.ShowResultWin(),e.abrupt("break",13);case 11:return this.ShowResultLose(),e.abrupt("break",13);case 13:e.next=17;break;case 15:e.prev=15,e.t1=e.catch(0);case 17:case"end":return e.stop()}}),e,this,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),s.ShowCharacterHurtEffect=function(e,t){return this.effectManager.HurtEffect(e,t)},s.ShowAttackHitEffect=function(e,t){this.effectManager.HitEffect(e,t)},s.RefreshCurrentPlayerInfo=function(e){this.playerStatus.SetPlayerStatus(e)},s.RenderAttackRange=function(e,t){this.mapViewer.RenderMapColor(e,t)},s.CancelShowRange=function(){for(var e=this.manager.mapRange.x,t=this.manager.mapRange.y,a=0;a<t;a++)for(var r=0;r<e;r++)this.mapViewer.RenderMapColor([new S(r,a)],this.manager.mapData.moveMap[a][r].canArrvied?m.CYAN:m.GRAY)},s.RenderMoveRange=function(){for(var e=this.manager.mapRange.x,t=this.manager.mapRange.y,a=0;a<t;a++)for(var r=0;r<e;r++)this.mapViewer.RenderMapColor([new S(r,a)],this.manager.mapData.moveMap[a][r].canArrvied?m.CYAN:m.GRAY)},s.ShowBehaviorBtn=function(){for(var e=null,t=0;t<this.manager.charatersData.length;t++){if("moving"===this.manager.charatersData[t].behaviorStatus){e="moving";break}e="idel"}switch(console.log(e),e){case"moving":this.btn_EndTurn.interactable=!1;break;case"idel":this.btn_EndTurn.interactable=!0}},s.HideBehaviorBtn=function(){console.log("hide"),this.btn_EndTurn.interactable=!1},s.TakeCardAni=function(e,t){this.cardViewer.AddCard(e,t)},s.UseCard=function(){this.cardViewer.RemoveCard()},s.CleanHandleCard=function(){this.cardViewer.Center.removeAllChildren()},s.ShowResultWin=function(){this.mainCam.enabled=!1,this.resultViewer.ShowWin()},s.ShowResultLose=function(){this.mainCam.enabled=!1,this.resultViewer.ShowLose()},t}(p)).prototype,"mainCam",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(B.prototype,"btn_EnsureMove",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=t(B.prototype,"btn_EndTurn",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=t(B.prototype,"FriendStatus",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=t(B.prototype,"EnemyStatus",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=t(B.prototype,"playerStatus",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=t(B.prototype,"cardViewer",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=t(B.prototype,"effectManager",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=t(B.prototype,"resultViewer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=B))||z));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AITest.ts","./CardViewer.ts","./Cardtest.ts","./GameClass.ts","./GameData.ts","./GameManager.ts","./GameViewer.ts","./AIManager.ts","./Arms.ts","./CardManager.ts","./EffectManager.ts","./MoveManager.ts","./SoundManager.ts","./CharacterViewer.ts","./MapViewer.ts","./PlayerViewer.ts","./ResultViewer.ts","./SmallCharacterViewer.ts","./StatusViewer.ts","./test.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MapViewer.ts",["cc","./GameClass.ts"],(function(e){"use strict";var t,a,r;return{setters:[function(e){t=e.cclegacy,a=e._decorator},function(e){r=e.SeatConvertMapSeat}],execute:function(){var n;t._RF.push({},"81aedxBuohE95XBNqmUvvPS","MapViewer",void 0);var o=a.ccclass;a.property,e("MapViewer",o("MapViewer")(n=function(){function e(e,t){this.mapRange=null,this.mapPlates=[],this.mapRange=t,this.mapPlates=e}var t=e.prototype;return t.RenderMapColor=function(e,t){var a=this,n=[];e.forEach((function(e){n.push(r(e,a.mapRange))})),n.forEach((function(e){a.mapPlates[e].color=t}))},t.RenderMapColorIndex=function(e,t){var a=this;e.forEach((function(e){a.mapPlates[e].color=t}))},e}())||n);t._RF.pop()}}}));

System.register("chunks:///_virtual/MoveManager.ts",["cc","./GameClass.ts"],(function(t){"use strict";var e,i,n;return{setters:[function(t){e=t.cclegacy,i=t._decorator},function(t){n=t.Seat}],execute:function(){var a;e._RF.push({},"f1804FnAtRB6qM0fnrQ9nva","MoveManager",void 0);var r=i.ccclass,s=(i.property,t("MoveManager",r("MoveManager")(a=function(){function t(t,e){this.data=[],this.BigMap=[],this.moveMap=[],this.mapRange=null,this.data=t,this.mapRange=e,this.Initial()}var e=t.prototype;return e.Initial=function(){this.SetMap(),this.moveMap.forEach((function(t){t.forEach((function(t){t.canArrvied=!1}))}))},e.MoveInitial=function(t,e){this.SetMap(),this.SetObstruct(t),this.SetArrvied(t,e)},e.AttackInitial=function(t,e){this.SetMap(),this.SetArrvied(t,e)},e.SetMap=function(){this.BigMap=[],this.moveMap=[];for(var t=0;t<this.mapRange.y;t++){for(var e=[],i=[],n=0;n<this.mapRange.x;n++)e.push(!0),i.push(new s);this.BigMap.push(e),this.moveMap.push(i)}},e.SetObstruct=function(t){var e=this,i=[];this.data.forEach((function(e){e.seat!=t&&i.push(e.seat)})),i.forEach((function(t){e.BigMap[t.y][t.x]=!1}))},e.SetArrvied=function(t,e){this.moveMap[t.y][t.x].Check(this.mapRange,this.moveMap,this.BigMap,t,e)},e.SearchSeatCanArrived=function(t){return this.moveMap[t.y][t.x].canArrvied},t}())||a),t("Plate",function(){function t(){this.hasArrived=!1,this.canArrvied=!1,this.energy=0}return t.prototype.Check=function(t,e,i,a,r){i[a.y][a.x]&&(!this.hasArrived||this.hasArrived&&r>e[a.y][a.x].energy)&&(this.hasArrived=!0,this.canArrvied=r>=0,this.energy=r--,this.energy>0&&(a.x<t.x-1&&e[a.y][a.x+1].Check(t,e,i,new n(a.x+1,a.y),this.energy-1),a.x>0&&e[a.y][a.x-1].Check(t,e,i,new n(a.x-1,a.y),this.energy-1),a.y<t.y-1&&e[a.y+1][a.x].Check(t,e,i,new n(a.x,a.y+1),this.energy-1),a.y>0&&e[a.y-1][a.x].Check(t,e,i,new n(a.x,a.y-1),this.energy-1)))},t}()));e._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerViewer.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var r,t,i,n,a,o,l,s,u,c;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,l=e.Label,s=e.ProgressBar,u=e.tween,c=e.Component}],execute:function(){var y,p,b,g,_,f,w,h,E,x,m;a._RF.push({},"32b2bb/FIFATL91wIEX+A3l","PlayerViewer",void 0);var C=o.ccclass,P=o.property;e("PlayerViewer",(y=C("PlayerViewer"),p=P(l),b=P(l),g=P(s),_=P(s),y((h=r((w=function(e){function r(){for(var r,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return r=e.call.apply(e,[this].concat(a))||this,i(r,"txt_Cost",h,n(r)),i(r,"txt_Energy",E,n(r)),i(r,"bar_Cost",x,n(r)),i(r,"bar_Energy",m,n(r)),r}return t(r,e),r.prototype.SetPlayerStatus=function(e){this.txt_Energy.string="剩餘移動力："+e.currentEnergy,u(this.bar_Energy).to(.2,{progress:e.currentEnergy/e.maxEnergy}).start(),this.txt_Cost.string=e.currentCost+" / "+e.maxCost+" "},r}(c)).prototype,"txt_Cost",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=r(w.prototype,"txt_Energy",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=r(w.prototype,"bar_Cost",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=r(w.prototype,"bar_Energy",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=w))||f));a._RF.pop()}}}));

System.register("chunks:///_virtual/ResultViewer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SoundManager.ts","./GameData.ts"],(function(e){"use strict";var t,n,r,a,i,l,o,c,s,u,h,b,g,p,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){i=e.cclegacy,l=e._decorator,o=e.SpriteFrame,c=e.Label,s=e.Sprite,u=e.Button,h=e.director,b=e.game,g=e.Component},function(e){p=e.SoundManager},function(e){d=e.GameData}],execute:function(){var f,y,m,S,_,w,P,v,G,I,L,z,A,D,M,R,B;i._RF.push({},"da2e23yg6tIJq5sEXYHRHgT","ResultViewer",void 0);var E=l.ccclass,F=l.property;e("ResultViewer",(f=E("ResultViewer"),y=F(o),m=F(c),S=F(c),_=F(c),w=F(s),P=F(u),v=F(u),f((L=t((I=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return t=e.call.apply(e,[this].concat(i))||this,r(t,"headerSource",L,a(t)),r(t,"headerLabel",z,a(t)),r(t,"label_PlayAgain",A,a(t)),r(t,"label_EndGame",D,a(t)),r(t,"headerSprite",M,a(t)),r(t,"btn_PlayAgain",R,a(t)),r(t,"btn_EndGame",B,a(t)),t}n(t,e);var i=t.prototype;return i.start=function(){this.btn_PlayAgain.node.on("click",(function(){console.log("again"),h.loadScene("scene")}),this),this.btn_EndGame.node.on("click",(function(){b.end()}),this)},i.ShowWin=function(){for(var e=0;e<2;e++)d.Instance.currentStage==d.Instance.stageCharatersData.length-1?(this.headerLabel[e].string="通關！",this.label_PlayAgain[e].string="重新來過"):(this.headerLabel[e].string="勝利！",this.label_PlayAgain[e].string="下一關卡");d.Instance.currentStage==d.Instance.stageCharatersData.length-1?d.Instance.currentStage=0:d.Instance.currentStage+=1,this.headerSprite.spriteFrame=this.headerSource[0],this.node.active=!0,p.Instance.PlayBGM("BGM_Win",!1)},i.ShowLose=function(){for(var e=0;e<2;e++)this.headerLabel[e].string="失敗！",this.label_PlayAgain[e].string="再次挑戰";this.headerSprite.spriteFrame=this.headerSource[1],this.node.active=!0,p.Instance.PlayBGM("BGM_Lose",!1)},t}(g)).prototype,"headerSource",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z=t(I.prototype,"headerLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),A=t(I.prototype,"label_PlayAgain",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),D=t(I.prototype,"label_EndGame",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=t(I.prototype,"headerSprite",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(I.prototype,"btn_PlayAgain",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(I.prototype,"btn_EndGame",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=I))||G));i._RF.pop()}}}));

System.register("chunks:///_virtual/SmallCharacterViewer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameClass.ts"],(function(a){"use strict";var t,e,i,n,r,l,s,o,c,h,p,u,y,d;return{setters:[function(a){t=a.applyDecoratedDescriptor,e=a.inheritsLoose,i=a.initializerDefineProperty,n=a.assertThisInitialized,r=a.asyncToGenerator,l=a.regeneratorRuntime},function(a){s=a.cclegacy,o=a._decorator,c=a.ProgressBar,h=a.Label,p=a.Animation,u=a.tween,y=a.Component},function(a){d=a.Status}],execute:function(){var f,m,g,b,C,H,_,I,D,v,x;s._RF.push({},"959ee+WClxGCKxxfxFC31pe","SmallCharacterViewer",void 0);var B=o.ccclass,w=o.property;a("SmallCharacterViewer",(f=B("SmallCharacterViewer"),m=w(c),g=w(c),b=w(h),C=w(p),f((I=t((_=function(a){function t(){for(var t,e=arguments.length,r=new Array(e),l=0;l<e;l++)r[l]=arguments[l];return t=a.call.apply(a,[this].concat(r))||this,i(t,"HPBar",I,n(t)),i(t,"BlockBar",D,n(t)),i(t,"damage",v,n(t)),i(t,"ani",x,n(t)),t.data=null,t}e(t,a);var s=t.prototype;return s.Initial=function(a){this.data=a,u(this.HPBar).to(.2,{progress:0==this.data.maxHp?0:this.data.currentHp/this.data.maxHp}).start(),u(this.BlockBar).to(.2,{progress:0==this.data.maxDef?0:this.data.currentDef/this.data.maxHp}).start(),"Friendly"==this.data.tag?this.ani.play("UnityChan_Idle"):this.ani.play("Goblin_Idle")},s.SetBlock=function(){u(this.BlockBar).to(.2,{progress:0==this.data.maxDef?0:this.data.currentDef/this.data.maxHp}).start()},s.SetHp=function(){u(this.HPBar).to(.2,{progress:0==this.data.maxHp?0:this.data.currentHp/this.data.maxHp}).start()},s.PlayCharacterDeath=function(){var a=r(l().mark((function a(){var t=this;return l().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,new Promise((function(a){t.ani.off(p.EventType.FINISHED),"Friendly"==t.data.tag?t.ani.play("UnityChan_Death"):t.ani.play("Goblin_Death"),t.ani.on(p.EventType.FINISHED,(function(){a()}))}));case 2:this.node.destroy();case 3:case"end":return a.stop()}}),a,this)})));return function(){return a.apply(this,arguments)}}(),s.PlayCharacterAni=function(a,t){var e=this;switch(this.ani.on(p.EventType.FINISHED,(function(){t(),e.ani.off(p.EventType.FINISHED),"Friendly"==e.data.tag?e.ani.play("UnityChan_Idle"):e.ani.play("Goblin_Idle")}),this),a){case d.Idel:"Friendly"==this.data.tag?this.ani.play("UnityChan_Idle"):this.ani.play("Goblin_Idle");break;case d.Attack:"Friendly"==this.data.tag?"Archer"==this.data.armTag?this.ani.play("UnityChan_Archer_Attack"):this.ani.play("UnityChan_Attack"):this.ani.play("Goblin_Attack");break;case d.damage:"Friendly"==this.data.tag?this.ani.play("UnityChan_Damage"):this.ani.play("Goblin_Damage")}},t}(y)).prototype,"HPBar",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(_.prototype,"BlockBar",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(_.prototype,"damage",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(_.prototype,"ani",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=_))||H));s._RF.pop()}}}));

System.register("chunks:///_virtual/SoundManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var n,t,r,i,a,s,c,l,o,u,p,f;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){c=e.cclegacy,l=e._decorator,o=e.AudioSource,u=e.AudioClip,p=e.Component,f=e.resources}],execute:function(){var h,b,x,y,S,g,d,k,m,F,E,X;c._RF.push({},"2537dRcpwBHsrKf1an66ORG","SoundManager",void 0);var v=l.ccclass,w=l.property;e("SoundManager",(h=v("SoundManager"),b=w(o),x=w(o),y=w(u),S=w(u),h(((X=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=e.call.apply(e,[this].concat(a))||this,r(n,"bgm",k,i(n)),r(n,"sfex",m,i(n)),r(n,"BGMclips",F,i(n)),r(n,"SEFXclips",E,i(n)),n.canPlaySFEX=!0,n}t(n,e);var c=n.prototype;return c.onLoad=function(){n.Instance=this},c.PlayBGM=function(){var e=a(s().mark((function e(n,t){var r,i,a,c=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.bgm.stop(),r=!1,i=null,a=0;case 4:if(!(a<this.BGMclips.length)){e.next=12;break}if(this.BGMclips[a].name!=n){e.next=9;break}return r=!0,i=this.BGMclips[a],e.abrupt("break",12);case 9:a++,e.next=4;break;case 12:if(!r){e.next=19;break}console.log("此BGM音檔已載入"),this.bgm.clip=i,this.bgm.loop=t,this.bgm.play(),e.next=21;break;case 19:return e.next=21,f.load("Sound/"+n,u,(function(e,n){if(null!=e)throw e;c.bgm.clip=n,c.BGMclips.push(n),c.bgm.loop=t,c.bgm.play()}));case 21:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),c.PlaySEFX=function(){var e=a(s().mark((function e(n){var t,r,i,a=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.canPlaySFEX){e.next=20;break}t=!1,r=null,i=0;case 4:if(!(i<this.SEFXclips.length)){e.next=12;break}if(this.SEFXclips[i].name!=n){e.next=9;break}return t=!0,r=this.SEFXclips[i],e.abrupt("break",12);case 9:i++,e.next=4;break;case 12:if(!t){e.next=18;break}console.log("此音檔已載入"+n),this.sfex.clip=r,this.sfex.playOneShot(r,1),e.next=20;break;case 18:return e.next=20,f.load("Sound/"+n,u,(function(e,t){if(console.log("此音檔已從資源載入"+n),null!=e)throw e;a.sfex.clip=t,a.SEFXclips.push(t),a.sfex.playOneShot(t,1)}));case 20:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),c.PlayContinueSEFX=function(){var e=a(s().mark((function e(n){var t,r,i,a=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.canPlaySFEX){e.next=22;break}t=!1,r=null,i=0;case 4:if(!(i<this.SEFXclips.length)){e.next=12;break}if(this.SEFXclips[i].name!=n){e.next=9;break}return t=!0,r=this.SEFXclips[i],e.abrupt("break",12);case 9:i++,e.next=4;break;case 12:if(!t){e.next=20;break}console.log("此音檔已載入"+n),this.sfex.clip=r,this.sfex.playOneShot(r,1),this.canPlaySFEX=!1,this.scheduleOnce((function(){a.canPlaySFEX=!0}),.025),e.next=22;break;case 20:return e.next=22,f.load("Sound/"+n,u,(function(e,n){if(null!=e)throw e;a.sfex.clip=n,a.SEFXclips.push(n),a.sfex.playOneShot(n,1),a.canPlaySFEX=!1,a.scheduleOnce((function(){a.canPlaySFEX=!0}),.025)}));case 22:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),n}(p)).Instance=null,k=n((d=X).prototype,"bgm",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=n(d.prototype,"sfex",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=n(d.prototype,"BGMclips",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E=n(d.prototype,"SEFXclips",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),g=d))||g));c._RF.pop()}}}));

System.register("chunks:///_virtual/StatusViewer.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,i,a,r,n,l,o,c,u,s,p,b,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,a=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){n=t.cclegacy,l=t._decorator,o=t.Sprite,c=t.Label,u=t.ProgressBar,s=t.Node,p=t.tween,b=t.Vec3,g=t.Component}],execute:function(){var f,_,m,h,w,d,y,k,v,B,S,x,H,z,P,A,F,N,V,I,C;n._RF.push({},"a0ab0NDY0FIE4ILAFJJ246y","StatusViewer",void 0);var D=l.ccclass,L=l.property;t("StatusViewer",(f=D("StatusViewer"),_=L(o),m=L(c),h=L(c),w=L(c),d=L(c),y=L(o),k=L(u),v=L(u),B=L(s),f((H=e((x=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return e=t.call.apply(t,[this].concat(n))||this,a(e,"im_Background",H,r(e)),a(e,"txt_HP",z,r(e)),a(e,"txt_Block",P,r(e)),a(e,"txt_Name",A,r(e)),a(e,"txt_Attack",F,r(e)),a(e,"s_Head",N,r(e)),a(e,"bar_HP",V,r(e)),a(e,"bar_Block",I,r(e)),a(e,"main",C,r(e)),e}i(e,t);var n=e.prototype;return n.SetName=function(t){this.txt_Name.string=t},n.SetHP=function(t,e){this.txt_HP.string="HP:"+t+"/"+e,p(this.bar_HP).to(.2,{progress:0==e?0:t/e}).start()},n.SetBlock=function(t,e){this.txt_Block.string="Block:"+t+"/"+e,p(this.bar_Block).to(.2,{progress:0==e?0:t/e}).start()},n.SetCharacterValue=function(t,e){this.txt_Attack.string="ATK:"+t+" MoveRange:"+e},n.SetHeadSprite=function(t){this.s_Head.spriteFrame=t},n.CallFriendInfoShow=function(){var t=this;console.log("call"),this.main.active=!1,p(this.im_Background.node).to(.15,{scale:new b(0,1,1)},{easing:"quadOut"}).to(.5,{scale:new b(-1,1,1)},{easing:"backOut"}).call((function(){t.main.active=!0})).start()},n.CallEnemyInfoShow=function(){var t=this;console.log("call"),p(this.im_Background.node).to(.1,{scale:new b(0,1,1)},{easing:"quadOut"}).call((function(){t.main.active=!1,t.main.active=!0})).to(.15,{scale:new b(-1,1,1)},{easing:"backOut"}).start()},e}(g)).prototype,"im_Background",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(x.prototype,"txt_HP",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=e(x.prototype,"txt_Block",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=e(x.prototype,"txt_Name",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=e(x.prototype,"txt_Attack",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=e(x.prototype,"s_Head",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=e(x.prototype,"bar_HP",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=e(x.prototype,"bar_Block",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=e(x.prototype,"main",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=x))||S));n._RF.pop()}}}));

System.register("chunks:///_virtual/test.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,r,n,i,o,s,a,c,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,n=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,s=t._decorator,a=t.Camera,c=t.Node,l=t.Component}],execute:function(){var u,p,f,h,y;o._RF.push({},"893fbjMoXNJvYOUpshbCRVn","test",void 0);var v=s.ccclass,d=s.property;t("test",(u=v("test"),p=d(a),u((y=e((h=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o))||this,n(e,"cam",y,i(e)),e}return r(e,t),e.prototype.start=function(){var t=this;this.node.on(c.EventType.MOUSE_DOWN,(function(e){t.node.parent=null}),this)},e}(l)).prototype,"cam",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=h))||f));o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});